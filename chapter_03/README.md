# Работа с данными

### Загрузка набора данных в проект D3

Загрузка данных из источника (папка data) с помощью функции ` d3.csv()`, передав ей путь к файлу в первом параметре. Так как файл данных находится в папке /data, относительный путь к нему из **main.js** выглядит так: **_../data/data.csv_**. Здесь две точки ("..") - обозначают каталог уровнем выше текущего.

```js
d3.csv('../data/data.csv');
```

Важно знать, что загрузка данных - это **_асинхронный процесс_**.
**Асинхронные операции** - это запросы, результат которых недоступен немедленно.

### Форматирование набора данных

Функцию обратного вызова, что передается в **d3.csv()**, также называют **_функцией преобразования записей_**, потому что она получает доступ к данным построчно.
В следующем фрагменте первый аргумент d3.csv() - это **_путь к данным_**, а второй - **_функция обратного вызова_**, которая выводит данные в консоль.

```js
d3.csv('../data/data.csv', (d) => {
  console.log(d);
});
```

Обратите внимание, что значения из столбца **_count_** извлечены как строки, а не числа. Это распространенная проблема при импорте данных, связанная с преобразованием набора данных из формата CSV в формат JSON.
Поэтому, в следующем фрагменте вместо вывода каждой строки данных в консоль мы возвращаем объект, содержащий пары ключ-значение

```js
d3.csv('../data/data.csv', (d) => {
  return {
    technology: d.technology,
    count: +d.count,
  };
});
```

### Оценка набора данных

Для возможности иметь доступ к набору данных в целом, можно воспользоваться JS-объектом **Promise**.
Объект **Promise** - это результат выполнения асинхронной операции, такой как **_d3.csv()_**. Самый простой способ извлечь данные из **Promise** - использовать метод **_then()_**.

```js
d3.csv('../data/data.csv', (d) => {
  return {
    technology: d.technology,
    count: +d.count,
  };
}).then((data) => {
  console.log(data);
});
```

Методы для оценки данных: d3.max(), d3.min(), d3.extent()

```js
d3.max(data, (d) => d.count); // максимальное значение
d3.min(data, (d) => d.count); // минимальное значение
d3.extent(data, (d) => d.count); // возвращает массив с минимальным и максимальным занчениями. [20, 1078]
```

Метод сортировки данных в порядке убывания sort()

```js
data.sort((a, b) => b.count - a.count);
```

Все методы оценки данных запускаются все в том же методе then()

Промежуточный результат

```js
d3.csv('data/data.csv', (d) => {
  return {
    technology: d.technology,
    count: +d.count,
  };
})
  .then((data) => {
    console.log(
      'Максимальное значение',
      d3.max(data, (d) => d.count)
    );
    console.log(
      'Минимальное значение',
      d3.min(data, (d) => d.count)
    );
    console.log(
      'Минимальное и максимальное значение в массиве',
      d3.extent(data, (d) => d.count)
    );
    return data.sort((a, b) => b.count - a.count); // сортировка по убыванию
  })
  .then(console.log);
```

### Привязка данных к элементам DOM
